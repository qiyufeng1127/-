<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jarvis - Neon Rose V20.0</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --bg: #1A1A1C; --card: #2C2C2E; --p: #FF007F; --blue: #00D2FF; --g: #FFD700; --text: #ffffff; --highlight: #FF6347; }
        
        body { 
            background: var(--bg); 
            color: var(--text); 
            font-family: 'PingFang SC', sans-serif; 
            margin: 0; 
            display: grid; 
            grid-template-columns: 320px 1fr 380px; 
            height: 100vh; 
            gap: 15px; 
            padding: 15px; 
            overflow: hidden; 
        }

        .panel { 
            background: var(--card); 
            border-radius: 24px; 
            padding: 20px; 
            border: 1px solid #333; 
            display: flex; 
            flex-direction: column; 
            position: relative; 
        }

        .header { 
            font-size: 12px; 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            color: #777; 
            margin-bottom: 15px; 
            border-bottom: 1px solid #444; 
            padding-bottom: 8px; 
        }

        .header span { 
            color: var(--p); 
            text-shadow: 0 0 10px var(--p); 
        }

        .input-bar { 
            background: #000; 
            border: 1px solid #444; 
            border-radius: 12px; 
            padding: 8px 12px; 
            display: flex; 
            gap: 8px; 
            margin-top: 10px; 
        }

        input, button.p-btn { 
            font-size: 14px; 
            padding: 10px; 
            border-radius: 12px; 
            outline: none; 
        }

        input { 
            background: transparent; 
            border: none; 
            color: white; 
            flex: 1; 
        }

        button.p-btn { 
            background: var(--p); 
            color: #000; 
            border: none; 
            font-weight: bold; 
            cursor: pointer; 
            transition: 0.3s; 
        }

        button.p-btn:hover { 
            background: var(--highlight); 
        }

        .terminal { 
            flex: 1; 
            background: #111; 
            border: 1px solid #444; 
            border-radius: 15px; 
            padding: 15px; 
            font-family: monospace; 
            font-size: 12px; 
            color: var(--blue); 
            line-height: 1.6; 
            overflow-y: auto; 
        }

        /* Time-line and shop-item style */
        .time-node, .shop-item {
            background: #333;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        /* Hover Effects */
        .shop-item:hover, .mission:hover {
            background: var(--p);
            border-color: var(--p);
            box-shadow: 0 0 15px rgba(255, 0, 127, 0.2);
        }

        @media (max-width: 1024px) { 
            body { grid-template-columns: 1fr; } 
            .panel { height: 600px; }
        }
    </style>
</head>
<body id="main">
    <div id="emergency-overlay"></div>
    <!-- UI Panels here (status, timeline, jarvis core) -->
    <div class="panel">
        <div class="header">STATUS // <span>AGENT RANK</span></div>
        <canvas id="radar" style="max-height: 180px;"></canvas>
        <div style="margin-top:15px;">
            <div style="color:#555; font-size:10px;">CREDITS</div>
            <div style="font-size:32px; font-weight:bold; color:var(--g);">ü™ô <span id="coins">1000</span></div>
        </div>
        <div class="header" style="margin-top:20px;">DESIRE SHOP // <span>ÂÖëÊç¢</span></div>
        <div id="shopList" style="flex:1; overflow-y:auto;"></div>
        <div class="input-bar">
            <input type="text" id="shopIcon" placeholder="üé® ÂõæÊ†á" style="width:30px; flex:none;">
            <input type="text" id="shopName" placeholder="ÊÉ≥ÂÖëÊç¢ÁöÑ‰∫ã...">
            <input type="number" id="shopPrice" placeholder="ÈáëÂ∏Å" style="width:50px; flex:none;">
            <button onclick="addShopItem()">+</button>
        </div>
    </div>

    <div class="panel">
        <div class="header">TIMELINE // <span>24H LOGGING</span></div>
        <div id="timeline"></div>
        <div class="input-bar">
            <input type="text" id="mTitle" placeholder="ÂèëÂ∏ÉÊñ∞‰ªªÂä°...">
            <input type="time" id="mTime" style="width:100px;">
            <button class="p-btn" onclick="addMission()">DEPLOY</button>
        </div>
    </div>

    <div class="panel">
        <div class="header">JARVIS CORE // <span>INTELLIGENCE</span></div>
        <div class="terminal" id="jarvisMsg">> Ê≠£Âú®Á≠âÂæÖÊ∑±Â∫¶ËÆ∞ÂøÜÂêåÊ≠•...</div>
        <div class="input-bar">
            <input type="text" id="chatInput" placeholder="ËæìÂÖ•ÂøÉÊÉÖ„ÄÅÂ∑•‰ΩúÂêêÊßΩ„ÄÅÊôöÈ§êËÆ∞ÂΩï..." onkeypress="if(event.key==='Enter') sendChat()">
        </div>
        <button class="p-btn" onclick="askJarvis()">Ë¥æÁª¥ÊñØÔºåÂàÜÊûêËÆ∞ÂøÜÂπ∂ÊãÜËß£‰ªªÂä°</button>
    </div>

    <audio id="alarm" src="https://assets.mixkit.co/active_storage/sfx/951/951-preview.mp3" loop></audio>

    <script>
        const SUPABASE_URL = 'https://zcnmdyvaxrjjhvymjzsb.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_JVEN8RBiF0xuPKl2oVhpQA_rywUiJTY';
        const DEEPSEEK_KEY = 'sk-520f594ef712411d97f24cf387047c1c';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let missions = [], coinCount = 1000, shopItems = [];
        // Initialize, render, and handle interactions
        init();
    </script>
</body>
</html>
