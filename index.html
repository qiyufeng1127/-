<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Jarvis - Fixed Command Deck</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --bg: #131314; --card: #1E1E20; --p: #FF007F; --blue: #00D2FF; --g: #FFD700; --text: #E3E3E3;
        }
        body { 
            background: var(--bg); color: var(--text); font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0; padding: 20px; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle at 2px 2px, #333 1px, transparent 0);
            background-size: 40px 40px;
        }

        #workspace { display: flex; flex-wrap: wrap; gap: 20px; align-content: flex-start; height: 100%; }

        /* é¢æ¿åŸºç¡€ */
        .panel { 
            background: var(--card); border-radius: 20px; padding: 15px; 
            border: 1px solid #333; display: flex; flex-direction: column; 
            position: relative; resize: both; overflow: hidden;
            width: 380px; height: 500px; cursor: grab;
        }

        .header { 
            font-size: 10px; text-transform: uppercase; letter-spacing: 2px; 
            color: #888; margin-bottom: 12px; border-bottom: 1px solid #333; padding-bottom: 8px;
        }

        /* æ ¸å¿ƒä¿®æ”¹ï¼šå†…å®¹åŒºä¸å›ºå®šåº•éƒ¨çš„åˆ†ç¦»å¸ƒå±€ */
        .content-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* ç¡®ä¿å†…éƒ¨æ»šåŠ¨ä¸å½±å“å¤–éƒ¨ */
            position: relative;
        }

        .scroll-area { 
            flex: 1; 
            overflow-y: auto; 
            padding-bottom: 20px; /* ä¸ºåº•éƒ¨è¾“å…¥æ¡†ç•™å‡ºç©ºé—´ */
        }

        /* --- é†’ç›®çš„åº•éƒ¨å›ºå®šè¾“å…¥å° --- */
        .fixed-command-deck {
            background: #000;
            border: 2px solid var(--p);
            border-radius: 12px;
            padding: 10px 15px;
            display: flex;
            gap: 10px;
            margin-top: 10px;
            box-shadow: 0 -5px 20px rgba(255, 0, 127, 0.2); /* å‘ä¸Šæ‰©æ•£çš„å‘å…‰æ„Ÿ */
            position: relative;
            z-index: 10;
        }

        /* è£…é¥°ç”¨çš„å‘å…‰è§’ï¼ŒåŒ¹é…ä½ æˆªå›¾ä¸­çš„æ•ˆæœ */
        .fixed-command-deck::after {
            content: '';
            position: absolute;
            right: -2px;
            bottom: -2px;
            width: 15px;
            height: 15px;
            background: var(--p);
            clip-path: polygon(100% 0, 100% 100%, 0 100%);
            border-radius: 0 0 12px 0;
            filter: blur(2px);
        }

        input { background: transparent; border: none; color: white; outline: none; flex: 1; font-size: 14px; font-weight: 500; }
        input::placeholder { color: #555; }
        
        .deploy-btn { 
            background: var(--p); color: #000; border: none; border-radius: 8px; 
            font-weight: 900; cursor: pointer; padding: 5px 15px; font-size: 12px;
            transition: 0.2s;
        }
        .deploy-btn:hover { transform: scale(1.05); filter: brightness(1.2); }

        /* æ—¶é—´è½´èŠ‚ç‚¹ç¾åŒ–ï¼ˆå‚è€ƒç™½è‰²ç®€çº¦ç‰ˆï¼‰ */
        .timeline-item {
            display: flex; gap: 15px; margin-bottom: 20px; position: relative;
        }
        .timeline-left { display: flex; flex-direction: column; align-items: center; width: 50px; }
        .time-label { font-size: 10px; color: #777; white-space: nowrap; }
        .timeline-dot { 
            width: 12px; height: 12px; border: 2px solid var(--p); border-radius: 50%; 
            background: var(--bg); margin-top: 5px; z-index: 2;
        }
        .timeline-line { position: absolute; left: 24px; top: 20px; bottom: -20px; width: 2px; background: #333; }
        .timeline-content { flex: 1; background: rgba(255,255,255,0.03); border-radius: 12px; padding: 12px; border: 1px solid #2a2a2a; }

        .terminal { flex: 1; background: #0a0a0a; border-radius: 10px; padding: 10px; font-family: monospace; font-size: 11px; color: var(--blue); }
    </style>
</head>
<body>

    <div id="workspace">
        <div class="panel" draggable="true" id="timeline" style="width: 450px;">
            <div class="header">TIMELINE // <span>MONITORING</span></div>
            
            <div class="content-container" onmousedown="event.stopPropagation()">
                <div class="scroll-area" id="timelineList">
                    </div>

                <div class="fixed-command-deck">
                    <input type="text" id="mTitle" placeholder="ç¢ç¢å¿µæˆ–æ–°ä»»åŠ¡..." onkeypress="if(event.key==='Enter') deployMission()">
                    <button class="deploy-btn" onclick="deployMission()">DEPLOY</button>
                </div>
            </div>
        </div>

        <div class="panel" draggable="true" id="shop" style="width: 320px;">
            <div class="header">STATUS // <span>CORE ASSETS</span></div>
            <div class="content-inner" style="display:flex; flex-direction:column; height:100%;" onmousedown="event.stopPropagation()">
                <div style="text-align: center; margin: 20px 0;">
                    <div style="font-size:32px; color:var(--g); font-weight: bold;">ğŸª™ <span id="coinsDisplay">1000</span></div>
                    <div style="font-size:11px; color:#555;">è‡ªç”±é¢åº¦: 5000 åˆ†é’Ÿ</div>
                </div>
                <div class="header">SHOP // <span>REWARDS</span></div>
                <div class="scroll-area" id="shopList"></div>
            </div>
        </div>

        <div class="panel" draggable="true" id="brain" style="width: 350px; height: 300px;">
            <div class="header">JARVIS // <span>BRAIN</span></div>
            <div class="content-inner" style="display:flex; flex-direction:column; height:100%;" onmousedown="event.stopPropagation()">
                <div class="terminal" id="terminalBox">> åº•éƒ¨éƒ¨ç½²å°å·²åŠ å›ºã€‚</div>
            </div>
        </div>
    </div>

    <script>
        let state = {
            missions: [
                { title: "å‘ç…§ç›¸é¦†å°çº¢ä¹¦", time: "17:36", steps: ["ç­›é€‰ç…§ç‰‡", "æ’°å†™æ–‡æ¡ˆ", "æ£€æŸ¥æ’ç‰ˆ"] }
            ]
        };

        function render() {
            const list = document.getElementById('timelineList');
            list.innerHTML = state.missions.map((m, index) => `
                <div class="timeline-item">
                    <div class="timeline-line"></div>
                    <div class="timeline-left">
                        <span class="time-label">${m.time}</span>
                        <div class="timeline-dot"></div>
                    </div>
                    <div class="timeline-content">
                        <div style="font-weight:bold; color:var(--g); margin-bottom:8px;">${m.title}</div>
                        ${m.steps ? m.steps.map(s => `<div style="font-size:12px; color:#aaa; margin-bottom:4px;">â—‹ ${s}</div>`).join('') : ''}
                    </div>
                </div>
            `).join('');
            
            // æ¯æ¬¡æ¸²æŸ“åè‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œä»¥ä¾¿çœ‹åˆ°æœ€æ–°ä»»åŠ¡
            list.scrollTop = list.scrollHeight;
        }

        function deployMission() {
            const input = document.getElementById('mTitle');
            if(!input.value) return;
            
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0');
            
            state.missions.push({
                title: input.value,
                time: timeStr,
                steps: ["ç­‰å¾…è¯¦ç»†æ‹†è§£..."]
            });
            
            input.value = '';
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 }, colors: ['#FF007F', '#00D2FF'] });
            render();
        }

        // ç®€å•çš„é¢æ¿æ‹–æ‹½åˆå§‹åŒ–
        document.querySelectorAll('.panel').forEach(panel => {
            panel.ondragstart = (e) => {
                if (e.target.closest('.fixed-command-deck') || e.target.closest('.scroll-area')) {
                    e.preventDefault(); return;
                }
                panel.classList.add('dragging');
            };
            panel.ondragend = () => panel.classList.remove('dragging');
        });

        render();
    </script>
</body>
</html>
