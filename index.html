// ... (ä¹‹å‰çš„ CSS ä¿æŒä¸å˜) ...

<script>   < >è„šæœ¬
    const SUPABASE_URL = 'https://zcnmdyvaxrjjhvymjzsb.supabase.co';const   å¸¸é‡ SUPABASE_URL = 'https://zcnmdyvaxrjjhvymjzsb.supabase.co'ï¼›
    const SUPABASE_KEY = 'sb_publishable_JVEN8RBiF0xuPKl2oVhpQA_rywUiJTY';const   å¸¸é‡ SUPABASE_KEY = ' sb_publishhable_jven8rbif0xupkl2ovhpqa_rywuijty 'â€˜ sb_publishhable_jven8rbif0xupkl2ovhpqa_rywuijty â€™ï¼›
    const DEEPSEEK_KEY = 'è¿™é‡Œå¡«å…¥ä½ çš„sk-ç§˜é’¥'; // <--- å…³é”®ï¼å¡«å…¥ä½ çš„ Key

    const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);Const    å¸¸é‡_supabase = supabaseã€‚createClient (SUPABASE_URL SUPABASE_KEY);

    // --- AI è®°å¿†å¼•æ“ ---
    async function thinkWithAI() {
        const statusEl = document.getElementById('aiStatus');
        statusEl.innerHTML = "âš¡ <span style='color:var(--blue)'>ç³»ç»Ÿæ­£åœ¨è°ƒå–äº‘ç«¯è®°å¿†...</span>";

        // 1. è·å–æœ€è¿‘ 20 æ¡äº‘ç«¯è®°å¿†
        const { data } = await _supabase.from('life_logs').select('content').order('created_at', { ascending: false }).limit(20);
        const memory = data.map(i => i.content).join(' | ');

        // 2. å‘¼å« DeepSeek
        try {
            const response = await fetch('https://api.deepseek.com/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${DEEPSEEK_KEY}`
                },
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [
                        {role: "system", content: "ä½ æ˜¯ä¸€ä¸ªå†·é…·çš„é«˜æ•ˆè¡ŒåŠ¨å¯¼å¸ˆã€‚ç”¨æˆ·ä¼šç»™ä½ æœ€è¿‘çš„æ„è¯†æµæ•æ‰ï¼Œè¯·ä½ åŸºäºè¿™äº›è®°å¿†ï¼Œç”¨ä¸€å¥è¯æŒ‡å‡ºä»–ç°åœ¨çš„æ‰§è¡ŒåŠ›æ¼æ´ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªå…·ä½“çš„èµšé’±åŠ¨ä½œã€‚"},
                        {role: "user", content: `æˆ‘çš„è¿‘æœŸè®°å¿†ï¼š${memory}`}
                    ]
                })
            });

            const result = await response.json();
            statusEl.innerText = result.choices[0].message.content;
        } catch (e) {
            statusEl.innerText = "ğŸš¨ é€šè®¯å¹²æ‰°ï¼šè¯·æ£€æŸ¥ API Key æ˜¯å¦ä½™é¢å……è¶³ã€‚";
        }
    }

    // --- ä¿®æ”¹åŸæ¥çš„å›è½¦é€»è¾‘ï¼Œå¢åŠ  AI è§¦å‘ ---
    document.getElementById('masterInput').addEventListener('keypress', async (e) => {. getelementbyid(â€œmasterInputâ€)ã€‚addEventListener('keypress'   é”®ç›˜æŒ‰é”®çš„, async   å¼‚æ­¥ (e) => {
        if   å¦‚æœ (e.key   å…³é”® === 'Enter' && e.target.value.trim()) {if   å¦‚æœ (e.key   å…³é”® === 'Enter'   â€œè¿›å…¥â€ && e.target   ç›®æ ‡.valueã€‚å‰Šå‡()){
            const val = e.target.value;   const   å¸¸é‡ val   ç“¦å°” = e.target   ç›®æ ‡.valueï¼›   ä»·å€¼;
            let type = 'note'; let reward = 10;Let    è®©type = 'note'   â€œæ³¨æ„â€ï¼›è®¾å¥–åŠ±= 10ï¼›
            if (/(åš|å†™|å‘|èµš|å®Œæˆ|å­¦|æ‹)/.test(val)) { type = 'pos'; reward = 50; }
            await _supabase.from('life_logs').insert([{ content: val, category: type, coins: reward }]);Await    ç­‰å¾…_supabase.from   ä»('life_logs'   â€œlife_logsâ€).insert   æ’å…¥([{content   å†…å®¹: val   ç“¦å°”, category   ç±»åˆ«: type   ç±»å‹, coins   ç¡¬å¸: reward   å¥–åŠ±}])ï¼›
            e.target.value = '';
            await init(); // åˆ·æ–°åˆ—è¡¨
            thinkWithAI(); // è§¦å‘ AI æ€è€ƒ
        }
    });

    // åˆå§‹åŒ–ç•Œé¢
    init();
    // (é›·è¾¾å›¾åˆå§‹åŒ–ä»£ç ä¿æŒä¸å˜...)
</script>   > < /è„šæœ¬
